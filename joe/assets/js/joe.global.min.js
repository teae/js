document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("data-night")?($(".joe_action_item.mode .icon-1").addClass("active"),$(".joe_action_item.mode .icon-2").removeClass("active")):($("html").removeAttr("data-night"),$(".joe_action_item.mode .icon-1").removeClass("active"),$(".joe_action_item.mode .icon-2").addClass("active")),$(".joe_action_item.mode").on("click",()=>{localStorage.getItem("data-night")?($(".joe_action_item.mode .icon-1").removeClass("active"),$(".joe_action_item.mode .icon-2").addClass("active"),$("html").removeAttr("data-night"),localStorage.removeItem("data-night")):($(".joe_action_item.mode .icon-1").addClass("active"),$(".joe_action_item.mode .icon-2").removeClass("active"),$("html").attr("data-night","night"),localStorage.setItem("data-night","night"))}),Joe.IS_MOBILE||"off"===Joe.DYNAMIC_BACKGROUND||!Joe.DYNAMIC_BACKGROUND||Joe.WALLPAPER_BACKGROUND_PC||$.getScript(window.Joe.THEME_URL+`assets/backdrop/${Joe.DYNAMIC_BACKGROUND}`),$(".joe_header__above-search .input").on("click",e=>{e.stopPropagation(),$(".joe_header__above-search .result").addClass("active")}),$(document).on("click",function(){$(".joe_header__above-search .result").removeClass("active")}),$(".joe_dropdown").each(function(e,t){const o=$(this).find(".joe_dropdown__menu"),a=$(t).attr("trigger")||"click",n=$(t).attr("placement")||$(this).height()||0;o.css("top",n),"hover"===a?$(this).hover(()=>$(this).addClass("active"),()=>$(this).removeClass("active")):($(this).on("click",function(e){$(this).toggleClass("active"),$(document).one("click",()=>$(this).removeClass("active")),e.stopPropagation()}),o.on("click",e=>e.stopPropagation()))});{let e=null;const t=()=>(document.documentElement.scrollTop||document.body.scrollTop)>300?$(".joe_action_item.scroll").addClass("active"):$(".joe_action_item.scroll").removeClass("active");t(),$(document).on("scroll",()=>{clearTimeout(e),e=setTimeout(t,80)}),$(".joe_action_item.scroll").on("click",()=>window.scrollTo({top:0,behavior:"smooth"}))}if($(".joe_aside__item.timelife").length){let e=[{title:"今日已经过去",endTitle:"小时",num:0,percent:"0%"},{title:"这周已经过去",endTitle:"天",num:0,percent:"0%"},{title:"本月已经过去",endTitle:"天",num:0,percent:"0%"},{title:"今年已经过去",endTitle:"个月",num:0,percent:"0%"}];{let t=+new Date,o=new Date((new Date).toLocaleDateString()).getTime(),a=(t-o)/1e3/60/60,n=a/24*100;e[0].num=parseInt(a),e[0].percent=parseInt(n)+"%"}{let t={0:7,1:1,2:2,3:3,4:4,5:5,6:6},o=t[(new Date).getDay()],a=o/7*100;e[1].num=parseInt(o),e[1].percent=parseInt(a)+"%"}{let t=(new Date).getFullYear(),o=(new Date).getDate(),a=(new Date).getMonth()+1,n=new Date(t,a,0).getDate(),i=o/n*100;e[2].num=o,e[2].percent=parseInt(i)+"%"}{let t=(new Date).getMonth()+1,o=t/12*100;e[3].num=t,e[3].percent=parseInt(o)+"%"}let t="";e.forEach((e,o)=>{t+=`\n\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t<div class="title">\n\t\t\t\t\t\t\t\t${e.title}\n\t\t\t\t\t\t\t\t<span class="text">${e.num}</span>\n\t\t\t\t\t\t\t\t${e.endTitle}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="progress">\n\t\t\t\t\t\t\t\t<div class="progress-bar">\n\t\t\t\t\t\t\t\t\t<div class="progress-bar-inner progress-bar-inner-${o}" style="width: ${e.percent}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="progress-percentage">${e.percent}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`}),$(".joe_aside__item.timelife .joe_aside__item-contain").html(t)}if($(".joe_aside__item.weather").length){const e=$(".joe_aside__item.weather").attr("data-key"),t=$(".joe_aside__item.weather").attr("data-style"),o={1:"FFFFFF",2:"4A4A4A",3:"FFFFFF"};window.WIDGET={CONFIG:{layout:2,width:"220",height:"270",background:t,dataColor:o[t],language:"zh",key:e}},$.getScript("https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0")}if($(".joe_aside__item.tags").length){const e=[],t=["#F8D800","#0396FF","#EA5455","#7367F0","#32CCBC","#F6416C","#28C76F","#9F44D3","#F55555","#736EFE","#E96D71","#DE4313","#D939CD","#4C83FF","#F072B6","#C346C2","#5961F9","#FD6585","#465EFB","#FFC600","#FA742B","#5151E5","#BB4E75","#FF52E5","#49C628","#00EAFF","#F067B4","#F067B4","#ff9a9e","#00f2fe","#4facfe","#f093fb","#6fa3ef","#bc99c4","#46c47c","#f9bb3c","#e8583d","#f68e5f"],o=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e);$(".joe_aside__item-contain .list li").each((a,n)=>{e.push({label:$(n).attr("data-label"),url:$(n).attr("data-url"),target:"_blank",fontColor:t[o(0,t.length-1)],fontSize:15})}),$(".joe_aside__item-contain .tag").svg3DTagCloud({entries:e,width:220,height:220,radius:"65%",radiusMin:75,bgDraw:!1,fov:800,speed:.5,fontWeight:500})}if($(".joe_aside__item.flatterer").length){const e=["=Test="],t=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),o=()=>{$(".joe_aside__item.flatterer .content").html(e[t(0,e.length-1)].replace(/\*\*(.*?)\*\*/g,"<mark>$1</mark>")),$(".joe_aside__item.flatterer .content").attr("class","content type"+t(1,6))};o(),$(".joe_aside__item.flatterer .change").on("click",()=>o())}if($(".joe_comment").length&&$(".joe_comment__respond-type .item").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),"draw"===$(this).attr("data-type")?($(".joe_comment__respond-form .body .draw").show().siblings().hide(),$("#joe_comment_draw").prop("width",$(".joe_comment__respond-form .body").width()),$(".joe_comment__respond-form").attr("data-type","draw")):($(".joe_comment__respond-form .body .text").show().siblings().hide(),$(".joe_comment__respond-form").attr("data-type","text"))}),$("#joe_comment_draw").length&&(window.sketchpad=new Sketchpad({element:"#joe_comment_draw",height:300,penSize:5,color:"303133"}),$(".joe_comment__respond-form .body .draw .icon-undo").on("click",()=>window.sketchpad.undo()),$(".joe_comment__respond-form .body .draw .icon-animate").on("click",()=>window.sketchpad.animate(10)),$(".joe_comment__respond-form .body .draw .line li").on("click",function(){window.sketchpad.penSize=$(this).attr("data-line"),$(this).addClass("active").siblings().removeClass("active")}),$(".joe_comment__respond-form .body .draw .color li").on("click",function(){window.sketchpad.color=$(this).attr("data-color"),$(this).addClass("active").siblings().removeClass("active")})),$(".joe_comment__respond").length){const e=$(".joe_comment__respond");$(".joe_comment__reply").on("click",function(){const t=$(this).attr("data-coid"),o=$("#"+$(this).attr("data-id"));e.find(".joe_comment__respond-form").attr("data-coid",t),o.append(e),$(".joe_comment__respond-type .item[data-type='text']").click(),$(".joe_comment__cancle").show(),window.scrollTo({top:o.offset().top-$(".joe_header").height()-15,behavior:"smooth"})}),$(".joe_comment__cancle").on("click",function(){e.find(".joe_comment__respond-form").removeAttr("data-coid"),$(".joe_comment__cancle").hide(),$(".joe_comment__title").after(e),$(".joe_comment__respond-type .item[data-type='text']").click(),window.scrollTo({top:$(".joe_comment").offset().top-$(".joe_header").height()-15,behavior:"smooth"})})}if($(".joe_comment").length){let e=!1;$(".joe_comment__respond-form").on("submit",function(t){t.preventDefault();const o=$(".joe_comment__respond-form").attr("action")+"?time="+ +new Date,a=$(".joe_comment__respond-form").attr("data-type"),n=$(".joe_comment__respond-form").attr("data-coid"),i=$(".joe_comment__respond-form .head input[name='author']").val(),s=$(".joe_comment__respond-form input[name='_']").val(),c=$(".joe_comment__respond-form .head input[name='mail']").val(),r=$(".joe_comment__respond-form .head input[name='url']").val();let d=$(".joe_comment__respond-form .body textarea[name='text']").val();if(""===i.trim())return Qmsg.info("请输入昵称！");if(!/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(c))return Qmsg.info("请输入正确的邮箱！");if("text"===a&&""===d.trim())return Qmsg.info("请输入评论内容！");if("draw"===a){const e=$("#joe_comment_draw")[0].toDataURL("image/webp",.1);d="{!{"+e+"}!} "}e||(e=!0,$(".joe_comment__respond-form .foot .submit button").html("发送中..."),$.ajax({url:o,type:"POST",data:{author:i,mail:c,text:d,parent:n,url:r,_:s},dataType:"text",success(t){let o=[],a="";o=$(t).contents(),Array.from(o).forEach(e=>{"container"===e.parentNode.className&&(a=e)}),/Joe/.test(t)?window.location.reload():(Qmsg.warning(a.textContent.trim()||""),e=!1,$(".joe_comment__respond-form .foot .submit button").html("发表评论"))},error(){e=!1,$(".joe_comment__respond-form .foot .submit button").html("发表评论"),Qmsg.warning("发送失败！请刷新重试！")}}))})}if($(".comment-list__item .term .content .user .author a").each((e,t)=>$(t).attr("target","_blank")),$(".joe_comment .joe_pagination a").each((e,t)=>{const o=$(t).attr("href");o&&o.includes("#")&&$(t).attr("href",o.replace("#comments","?scroll=joe_comment"))}),Joe.DOCUMENT_TITLE){const e=document.title;document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState?document.title=Joe.DOCUMENT_TITLE:document.title=e})}$(".joe_header__above-slideicon").on("click",function(){$(".joe_header__searchout").removeClass("active"),$(".joe_header__slideout").hasClass("active")?($("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__slideout").removeClass("active")):($("body").css("overflow","hidden"),$(".joe_header__mask").addClass("active slideout"),$(".joe_header__slideout").addClass("active"))}),$(".joe_header__above-searchicon").on("click",function(){$(".joe_header__slideout").removeClass("active"),$(".joe_header__searchout").hasClass("active")?($("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__searchout").removeClass("active")):($("body").css("overflow","hidden"),$(".joe_header__mask").addClass("active"),$(".joe_header__searchout").addClass("active"))}),$(".joe_header__mask").on("click",function(){$("body").css("overflow",""),$(".joe_header__mask").removeClass("active slideout"),$(".joe_header__searchout").removeClass("active"),$(".joe_header__slideout").removeClass("active")}),$(".joe_header__slideout-menu .current").parents(".panel-body").show().siblings(".panel").addClass("in"),$(".joe_header__slideout-menu .panel").on("click",function(){const e=$(this).parent().parent();e.find(".panel").not($(this)).removeClass("in"),e.find(".panel-body").not($(this).siblings(".panel-body")).stop().hide("fast"),$(this).toggleClass("in").siblings(".panel-body").stop().toggle("fast")});{const e=()=>{const e=new Date(Joe.BIRTHDAY),t=+new Date,o=t-e.getTime();let a=o/864e5,n=Math.floor(a),i=24*(a-n),s=Math.floor(i),c=60*(i-s),r=Math.floor(c),d=60*(c-r),_=Math.floor(d);a=String(n).padStart(2,0),i=String(s).padStart(2,0),c=String(r).padStart(2,0),d=String(_).padStart(2,0),$(".joe_run__day").html(a),$(".joe_run__hour").html(i),$(".joe_run__minute").html(c),$(".joe_run__second").html(d)};Joe.BIRTHDAY&&/(\d{4})\/(\d{1,2})\/(\d{1,2}) (\d{1,2})\:(\d{1,2})\:(\d{1,2})/.test(Joe.BIRTHDAY)&&(e(),setInterval(e,1e3))}$(".joe_owo__contain").length&&$(".joe_owo__target").length&&$.ajax({url:window.Joe.THEME_URL+"assets/json/joe.owo.json",dataType:"json",success(e){let t="",o="";for(let a in e){const n=e[a];t+=`<div class="item" data-type="${a}">${a}</div>`,o+=`\n                            <ul class="scroll" data-type="${a}">\n\t\t\t\t\t\t\t\t${n.map(e=>`<li class="item" data-text="${e.data}">${"颜文字"===a?`${e.icon}`:`<img src="${window.Joe.THEME_URL+e.icon}" alt="${e.data}"/>`}</li>`).join("")}\n                            </ul>\n                        `}$(".joe_owo__contain").html(`\n                        <div class="seat">OωO</div>\n                        <div class="box">\n                            ${o}\n                            <div class="bar">${t}</div>\n                        </div>\n                    `),$(document).on("click",function(){$(".joe_owo__contain .box").stop().slideUp("fast")}),$(".joe_owo__contain .seat").on("click",function(e){e.stopPropagation(),$(this).siblings(".box").stop().slideToggle("fast")}),$(".joe_owo__contain .box .bar .item").on("click",function(e){e.stopPropagation(),$(this).addClass("active").siblings().removeClass("active");const t='.joe_owo__contain .box .scroll[data-type="'+$(this).attr("data-type")+'"]';$(t).show().siblings(".scroll").hide()}),$(".joe_owo__contain .scroll .item").on("click",function(){const e=$(this).attr("data-text");$(".joe_owo__target").insertContent(e)}),$(".joe_owo__contain .box .bar .item").first().click()}});{let e=Joe.MOTTO;e||(e="有钱终成眷属，没钱亲眼目睹"),e.includes("http")?$.ajax({url:e,dataType:"text",success:e=>$(".joe_motto").html(e)}):$(".joe_motto").html(e)}if(!window.Joe.IS_MOBILE){let e=!0;const t=t=>{if(window.pageYOffset>=$(".joe_header").height()&&t<=0){if(e)return;$(".joe_header").addClass("active"),$(".joe_aside .joe_aside__item:last-child").css("top",$(".joe_header").height()-60+15),e=!0}else{if(!e)return;$(".joe_header").removeClass("active"),$(".joe_aside .joe_aside__item:last-child").css("top",$(".joe_header").height()+15),e=!1}};let o=window.pageYOffset;t(o);let a=Date.now();document.addEventListener("scroll",()=>{let e=Date.now();e-a>15&&(t(o-window.pageYOffset),o=window.pageYOffset),a=e})}});
